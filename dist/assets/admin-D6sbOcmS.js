import{a as N,j as e,b as se,R as Ne}from"./index-BHXMZ0-J.js";import{c as oe,A as S,f as ae,N as je,L as ve}from"./navigation-B0IDt7ps.js";import{P as re}from"./purchase-order-template-B5souN96.js";import{A as we}from"./arrow-left-COoKEq45.js";import{P as K}from"./plus-BuoTYnGG.js";import{T as G}from"./trash-D7KEJc6k.js";import{p as De,C as _e}from"./parseISO-BxmDVPrG.js";import{g as ke,D as Ce}from"./DayPicker-Cy1TBD3b.js";import{L as Se}from"./language-context-DF7eV6qf.js";import{F as le}from"./file-text-6k7I-qzz.js";import{R as W}from"./receipt-DldeSoSC.js";import{C as z}from"./clipboard-list-BivIav4i.js";import{T as X}from"./trash-2-BkAS_2wL.js";import"./addWeeks-yWatJi1q.js";/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=oe("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=oe("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);function ie({value:t,onChange:p,placeholder:n="DD/MM/YYYY"}){const[x,c]=N.useState(!1),f=N.useRef(null),y=ke(),D=(()=>{try{return t?De(t):void 0}catch{return}})(),j=(()=>{try{return D?ae(D,"dd/MM/yyyy"):""}catch{return""}})();return N.useEffect(()=>{if(!x)return;const h=u=>{const w=f.current;w&&!w.contains(u.target)&&c(!1)},a=u=>{u.key==="Escape"&&c(!1)};return document.addEventListener("mousedown",h),document.addEventListener("touchstart",h,{passive:!0}),document.addEventListener("keydown",a),()=>{document.removeEventListener("mousedown",h),document.removeEventListener("touchstart",h),document.removeEventListener("keydown",a)}},[x]),e.jsxs("div",{ref:f,className:"relative inline-block w-full",children:[e.jsx("input",{type:"text",value:j,placeholder:n,onClick:()=>c(h=>!h),readOnly:!0,className:"w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:ring-2 focus:ring-[#2D4485]/20 focus:border-[#2D4485] outline-none"}),e.jsx("button",{type:"button",onClick:()=>c(h=>!h),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 hover:text-slate-700","aria-label":"Open calendar",children:e.jsx(_e,{className:"size-4","aria-hidden":"true"})}),x&&e.jsx("div",{onMouseDown:h=>h.stopPropagation(),className:"absolute left-1/2 -translate-x-1/2 top-[calc(100%+2px)] z-50 bg-white border border-slate-200 rounded-[22px] shadow-xl p-4 w-[340px]",children:e.jsx(Ce,{mode:"single",selected:D,onSelect:h=>{if(!h)return;const a=ae(h,"yyyy-MM-dd");p(a)},captionLayout:"buttons",classNames:{root:`w-fit ${y.root}`,months:`flex flex-col ${y.months}`,month:`rounded-2xl pt-8 ${y.month}`,caption:`relative h-8 ${y.caption}`,nav:`absolute left-3 right-3 top-0 flex items-center justify-between ${y.nav}`,nav_button:`p-2 rounded-full hover:bg-slate-100 ${y.nav_button}`,nav_button_previous:`${y.nav_button_previous}`,nav_button_next:`${y.nav_button_next}`,caption_label:`absolute left-1/2 -translate-x-1/2 top-0 h-8 leading-8 text-center font-semibold uppercase tracking-wide text-[#2D4485] ${y.caption_label}`,table:"w-full border-collapse",weekdays:`flex justify-between border-b border-slate-200 pb-2 ${y.weekdays}`,weekday:`text-slate-500 flex-1 text-sm text-center ${y.weekday}`,week:`grid grid-cols-7 mt-2 ${y.week}`,day:`mx-auto size-10 flex items-center justify-center rounded-full hover:bg-blue-50 ${y.day}`,today:`bg-[#D6E4FF] text-[#2D4485] font-semibold ${y.today}`,outside:`text-slate-400 ${y.outside}`,disabled:`${y.disabled}`},modifiersClassNames:{selected:"border-2 border-[#2D4485]/30 !bg-transparent text-[#2D4485] font-semibold"}})})]})}function Pe(){const[t,p]=N.useState({company:"",name:"",email:"",companyEmail:"",phone:"",companyPhone:"",address:""}),[n,x]=N.useState({poNumber:"",orderDate:new Date().toISOString().slice(0,10),deliveryDate:"",refQuotation:"",paymentTerms:"",deliveryTo:"",eit:null,eitName:"EIT LASERTECHNIK CO.,LTD",eitAddress:"1/120 ซอยรามคําแหง 184 แขวงมีนบุรี เขตมีนบุรี กรุงเทพมหานคร 10510",eitPhone:"02-052-9544",eitFax:"02-052 9544",eitMobile:"000-000-0000",salesPerson:"",remark:"",currency:"THB"}),[c,f]=N.useState([]);N.useEffect(()=>{fetch(`${S}/api/eits/`).then(b=>b.json()).then(b=>{Array.isArray(b)?f(b):(console.error("EIT data is not an array:",b),f([]))}).catch(b=>{console.error("Error loading EITs",b),f([])})},[]);const[y,D]=N.useState([{product:"",description:"",note:"",qty:1,price:0,tax:0,unit:"pcs"}]),[j,h]=N.useState(null),[a,u]=N.useState(null),w=y.reduce((b,v)=>{const k=Number(v.qty)||0,A=Number(v.price)||0;return b+k*A},0),d=w*.07,g=w+d;return{vendor:t,setVendor:p,details:n,setDetails:x,eitOptions:c,items:y,setItems:D,addItem:()=>D(b=>[...b,{product:"",description:"",note:"",qty:1,price:0,tax:0,unit:"pcs"}]),removeItem:b=>D(v=>v.filter((k,A)=>A!==b)),updateItem:(b,v,k)=>D(A=>A.map((E,P)=>P===b?{...E,[v]:k}:E)),subtotal:w,taxTotal:d,total:g,sourceKey:j,setSourceKey:h,sourceIndex:a,setSourceIndex:u}}function Ie(){const t=Pe(),[p,n]=N.useState([]),[x,c]=N.useState(!1),[f,y]=N.useState(null),D=N.useRef(!1),j=N.useRef(null),[h,a]=N.useState(!1),[u,w]=N.useState([]),[d,g]=N.useState(!1),[m,_]=N.useState("po"),[l,b]=N.useState([]),[v,k]=N.useState(null),[A,E]=N.useState([]),[P,F]=N.useState(null),[J,H]=N.useState(null),[L,B]=N.useState({});N.useEffect(()=>{fetch(`${S}/api/customers/`).then(s=>s.json()).then(s=>{Array.isArray(s)&&E(s)}).catch(console.error)},[]);const[V,ne]=N.useState([]);N.useEffect(()=>{fetch(`${S}/api/quotations/`).then(s=>s.json()).then(s=>{Array.isArray(s)&&ne(s)}).catch(console.error)},[]);const R=N.useCallback(async()=>{try{const s=await fetch(`${S}/api/customer_purchase_orders/`);if(s.ok){const i=await s.json();b(i)}}catch(s){console.error("Failed to load customer POs",s)}},[]);N.useEffect(()=>{m==="customer_po"&&R()},[m,R]);const Z=async(s,i)=>{if(!i)return;const o=new FormData;o.append("po_file",i);try{(await fetch(`${S}/api/customer_purchase_orders/${s}/`,{method:"PATCH",body:o})).ok&&R()}catch(r){console.error("Upload failed",r),alert("Upload failed")}},ce=async s=>{try{const i=new FormData;s.write_customer_name&&i.append("write_customer_name",s.write_customer_name),s.po_number&&i.append("po_number",s.po_number),s.po_file&&i.append("po_file",s.po_file);const o=await fetch(`${S}/api/customer_purchase_orders/`,{method:"POST",body:i});if(o.ok)k(null),R();else{const r=await o.json();alert("Failed to create Customer Purchase Order: "+JSON.stringify(r))}}catch(i){console.error("Create failed",i),alert("Failed to create Customer Purchase Order")}},de=s=>{F(s)},me=async()=>{if(P)try{(await fetch(`${S}/api/customer_purchase_orders/${P}/`,{method:"DELETE"})).ok&&(R(),F(null))}catch(s){console.error("Delete failed",s)}},ee=s=>{var i;H(s.id),B({write_customer_name:s.customer_name||((i=s.customer_details)==null?void 0:i.company_name)||"",po_number:s.po_number||""})},ue=async()=>{if(J)try{const s=new FormData;L.write_customer_name&&s.append("write_customer_name",L.write_customer_name),L.po_number&&s.append("po_number",L.po_number);const i=await fetch(`${S}/api/customer_purchase_orders/${J}/`,{method:"PATCH",body:s});if(i.ok)R(),H(null),B({});else{const o=await i.json();alert("Failed to update: "+JSON.stringify(o))}}catch(s){console.error("Update failed",s),alert("Update failed")}},xe=s=>{s.target.checked?w(p.map(i=>i.sourceIndex)):w([])},he=s=>{u.includes(s)?w(i=>i.filter(o=>o!==s)):w(i=>[...i,s])},pe=async()=>{try{await Promise.all(u.map(s=>fetch(`${S}/api/purchase_orders/${s}/`,{method:"DELETE"}))),M(),w([]),g(!1)}catch(s){console.error("Batch delete failed",s),alert("Batch delete failed")}},M=N.useCallback(async()=>{try{const s=await fetch(`${S}/api/purchase_orders/`);if(s.ok){const o=(await s.json()).map(r=>{var C,I,T,O,$;return{poNumber:r.number,customer:r.customer,items:r.items,details:{poNumber:r.number,eit:((C=r.eit_details)==null?void 0:C.id)||r.eit,eitName:((I=r.extra_fields)==null?void 0:I.eitName)||((T=r.eit_details)==null?void 0:T.organization_name)||"",eitAddress:((O=r.extra_fields)==null?void 0:O.eitAddress)||(($=r.eit_details)==null?void 0:$.address)||"",...r.extra_fields},extraFields:r.extra_fields,updatedAt:r.updated_at,sourceKey:"api",sourceIndex:r.id}});n(o)}}catch(s){console.error("Failed to fetch POs",s)}},[]);N.useEffect(()=>{M()},[M]),N.useEffect(()=>{const s=new URLSearchParams(window.location.search),i=s.get("key"),o=s.get("index");i&&o&&(t.setSourceKey(i),t.setSourceIndex(o),i==="api"&&fetch(`${S}/api/purchase_orders/${o}/`).then(r=>r.json()).then(r=>{t.setDetails(C=>{var I,T,O,$,Q,q;return{...C,poNumber:r.po_code||"",orderDate:r.order_date||new Date().toISOString().slice(0,10),deliveryDate:r.delivery_date||"",refQuotation:r.ref_quotation||"",paymentTerms:r.payment_terms||"",deliveryTo:r.delivery_to||"",eit:((I=r.eit_details)==null?void 0:I.id)||null,eitName:((T=r.eit_details)==null?void 0:T.organization_name)||"EIT LASERTECHNIK CO.,LTD",eitAddress:((O=r.eit_details)==null?void 0:O.address)||"",eitPhone:(($=r.eit_details)==null?void 0:$.eit_telephone)||"",eitFax:((Q=r.eit_details)==null?void 0:Q.eit_fax)||"",eitMobile:((q=r.eit_details)==null?void 0:q.eit_mobile)||"",salesPerson:r.sales_person||"",remark:r.remark||"",currency:r.currency||"THB"}}),t.setVendor({company:r.vendor_company||"",name:r.vendor_name||"",email:r.vendor_email||"",companyEmail:r.vendor_company_email||"",phone:r.vendor_phone||"",companyPhone:r.vendor_company_phone||"",address:r.vendor_address||""}),Array.isArray(r.items)&&t.setItems(r.items),c(!0)}).catch(r=>console.error("Error loading PO from API:",r)))},[]);const Y=N.useCallback(()=>{const s=p.map(o=>{var r;return String(o.poNumber||((r=o.details)==null?void 0:r.poNumber)||"")}).map(o=>{const r=o.match(/^PO[-/ ]?(\d{1,5})$/i);return r?parseInt(r[1],10):null}).filter(o=>Number.isFinite(o)),i=s.length?Math.max(...s)+1:1;return`PO-${String(i).padStart(3,"0")}`},[p]);N.useEffect(()=>{if(x&&!t.details.poNumber){const s=Y();t.setDetails(i=>({...i,poNumber:s}))}},[x,t.details.poNumber,Y]);const te=N.useCallback(()=>{const s=(t.vendor.email||"").trim().toLowerCase();if(s)return s;const i=(t.vendor.companyEmail||"").trim().toLowerCase();if(i)return i;const o=(t.vendor.phone||"").trim();if(o)return o;const r=(t.vendor.name||"").trim().toLowerCase();return r||""},[t.vendor]);N.useEffect(()=>{if(!x)return;const s=te();if(s){if(!D.current)try{const i=JSON.parse(localStorage.getItem(`history:${s}`)||"{}"),o=i&&typeof i=="object"?i:{};o.customer&&(t.setVendor(r=>({...r,name:r.name||o.customer.name||"",company:r.company||o.customer.company||"",email:r.email||o.customer.email||"",companyEmail:r.companyEmail||o.customer.companyEmail||"",phone:r.phone||o.customer.phone||"",companyPhone:r.companyPhone||o.customer.companyPhone||"",address:r.address||o.customer.address||""})),o.customer.deliveryTo&&t.setDetails(r=>({...r,deliveryTo:r.deliveryTo||o.customer.deliveryTo})),D.current=!0)}catch{}return j.current&&clearTimeout(j.current),j.current=setTimeout(()=>{try{const i=JSON.parse(localStorage.getItem(`history:${s}`)||"{}"),o=i&&typeof i=="object"?i:{},r={...o,customer:{...t.vendor,deliveryTo:t.details.deliveryTo},quotations:Array.isArray(o.quotations)?o.quotations:[],invoices:Array.isArray(o.invoices)?o.invoices:[],emails:Array.isArray(o.emails)?o.emails:[]};localStorage.setItem(`history:${s}`,JSON.stringify(r))}catch{}},500),()=>{j.current&&(clearTimeout(j.current),j.current=null)}}},[x,t.vendor,t.details.deliveryTo,te]),N.useCallback(s=>{n(s);try{localStorage.setItem("poList",JSON.stringify(s))}catch{}},[]);const ge=()=>{t.setSourceKey(null),t.setSourceIndex(null),t.setDetails({poNumber:Y(),orderDate:new Date().toISOString().slice(0,10),deliveryDate:"",refQuotation:"",paymentTerms:"",deliveryTo:"",eit:null,eitName:"EIT LASERTECHNIK CO.,LTD",eitAddress:"1/120 ซอยรามคําแหง 184 แขวงมีนบุรี เขตมีนบุรี กรุงเทพมหานคร 10510",eitPhone:"02-052-9544",eitFax:"02-052 9544",eitMobile:"000-000-0000",salesPerson:"",remark:"",currency:"THB"}),t.setVendor({company:"",name:"",email:"",companyEmail:"",phone:"",companyPhone:"",address:""}),t.setItems([{product:"",description:"",note:"",qty:1,price:0,tax:0,unit:"pcs"}]),D.current=!1,c(!0)},be=s=>{var o,r,C,I,T,O;const i=p[s];i&&(t.setSourceKey(i.sourceKey),t.setSourceIndex(i.sourceIndex),t.setDetails({poNumber:i.poNumber||"",orderDate:((o=i.extraFields)==null?void 0:o.orderDate)||"",deliveryDate:((r=i.extraFields)==null?void 0:r.deliveryDate)||"",refQuotation:((C=i.extraFields)==null?void 0:C.refQuotation)||"",paymentTerms:((I=i.extraFields)==null?void 0:I.paymentTerms)||"",deliveryTo:((T=i.extraFields)==null?void 0:T.deliveryTo)||"",eit:((O=i.details)==null?void 0:O.eit)||null,eitName:"EIT LASERTECHNIK CO.,LTD",eitAddress:"1/120 ซอยรามคําแหง 184 แขวงมีนบุรี เขตมีนบุรี กรุงเทพมหานคร 10510",eitPhone:"02-052-9544",eitFax:"02-052 9544",eitMobile:"000-000-0000",salesPerson:"",remark:"",currency:"THB",...i.details}),t.setVendor(i.customer||{company:"",name:"",email:"",companyEmail:"",phone:"",companyPhone:"",address:""}),t.setItems(Array.isArray(i.items)&&i.items.length?i.items:[{product:"",description:"",note:"",qty:1,price:0,tax:0,unit:"pcs"}]),c(!0))},fe=async()=>{const s={number:t.details.poNumber,customer:t.vendor,eit:t.details.eit,eit_name:t.details.eitName,items:t.items,extra_fields:{orderDate:t.details.orderDate,deliveryDate:t.details.deliveryDate,refQuotation:t.details.refQuotation,paymentTerms:t.details.paymentTerms,deliveryTo:t.details.deliveryTo,remark:t.details.remark,currency:t.details.currency,salesPerson:t.details.salesPerson,eitName:t.details.eitName,eitAddress:t.details.eitAddress,eitPhone:t.details.eitPhone,eitFax:t.details.eitFax,eitMobile:t.details.eitMobile},totals:{}};try{let i=`${S}/api/purchase_orders/`,o="POST";t.sourceKey==="api"&&t.sourceIndex&&(i+=`${t.sourceIndex}/`,o="PUT");const r=await fetch(i,{method:o,headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(r.ok)alert("Purchase Order saved successfully!"),M(),c(!1);else{const C=await r.json();alert("Error saving Purchase Order: "+JSON.stringify(C))}}catch(i){console.error(i),alert("Error saving Purchase Order")}},ye=s=>{y(s)};return N.useEffect(()=>{if(f){const s=()=>{y(null)};window.addEventListener("afterprint",s);const i=setTimeout(()=>{window.print()},500);return()=>{window.removeEventListener("afterprint",s),clearTimeout(i)}}},[f]),x?e.jsxs("div",{className:"h-full",children:[f&&se.createPortal(e.jsxs("div",{id:"print-overlay",className:"fixed inset-0 z-[50] bg-white",children:[e.jsx("style",{children:`
               #print-overlay {
                  display: none;
               }
               @media print {
                 body {
                   visibility: hidden !important;
                 }
                 #print-overlay { 
                   visibility: visible !important;
                   display: block !important; 
                   position: absolute !important;
                   top: 0 !important;
                   left: 0 !important;
                   width: 100% !important;
                   height: 100% !important;
                   overflow: visible !important;
                   background: white !important;
                   z-index: 2147483647 !important;
                   padding: 0 !important;
                 }
                 #print-overlay * {
                   visibility: visible !important;
                 }
                 #print-overlay .print-content {
                   width: 100% !important;
                   margin: 0 !important;
                   box-shadow: none !important;
                 }
                 html, body {
                   height: auto !important;
                   overflow: visible !important;
                   background: white !important;
                 }
                 @page {
                   size: auto;
                   margin: 0mm;
                 }
               }
             `}),e.jsx("div",{className:"print-content bg-white p-0 relative",children:e.jsx(re,{q:f})})]}),document.body),e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>c(!1),className:"p-2 -ml-2 rounded-full hover:bg-gray-100 text-gray-600 transition-colors",title:"Back to List",children:e.jsx(we,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex items-center gap-3 text-[#2D4485]",children:[e.jsx(U,{className:"w-8 h-8"}),e.jsx("h1",{className:"text-3xl font-bold",children:"Purchase Order"})]})]}),e.jsx("div",{className:"flex items-center gap-3"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-400 p-6 space-y-8 mb-8",children:[e.jsx("h2",{className:"text-xl font-bold text-[#2D4485]",children:"Purchase Order Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PO Number"}),e.jsx("input",{value:t.details.poNumber,onChange:s=>t.setDetails({...t.details,poNumber:s.target.value}),className:"w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:ring-2 focus:ring-[#2D4485]/20 focus:border-[#2D4485] outline-none",placeholder:"PO Number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"QO Number"}),e.jsxs("select",{value:t.details.refQuotation,onChange:s=>{const i=s.target.value;t.setDetails({...t.details,refQuotation:i});const o=V.find(r=>{var C;return((C=r.qo_code)==null?void 0:C.toLowerCase())===(i==null?void 0:i.toLowerCase())});o&&t.setDetails(r=>{var C,I,T,O,$;return{...r,refQuotation:o.qo_code,eit:o.eit||r.eit,eitName:((C=o.eit_details)==null?void 0:C.organization_name)||r.eitName,eitAddress:((I=o.eit_details)==null?void 0:I.address)||r.eitAddress,eitPhone:((T=o.eit_details)==null?void 0:T.eit_telephone)||r.eitPhone,eitFax:((O=o.eit_details)==null?void 0:O.eit_fax)||r.eitFax,eitMobile:(($=o.eit_details)==null?void 0:$.eit_mobile)||r.eitMobile}})},className:"w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:ring-2 focus:ring-[#2D4485]/20 focus:border-[#2D4485] outline-none",children:[e.jsx("option",{value:"",children:"Select QO Number"}),t.details.refQuotation&&!V.find(s=>s.qo_code===t.details.refQuotation)&&e.jsxs("option",{value:t.details.refQuotation,children:[t.details.refQuotation," (Manual/Legacy)"]}),V.map(s=>e.jsx("option",{value:s.qo_code,children:s.qo_code},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order Date"}),e.jsx(ie,{value:t.details.orderDate,onChange:s=>t.setDetails({...t.details,orderDate:s})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Date"}),e.jsx(ie,{value:t.details.deliveryDate,onChange:s=>t.setDetails({...t.details,deliveryDate:s})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Terms"}),e.jsx("input",{value:t.details.paymentTerms,onChange:s=>t.setDetails({...t.details,paymentTerms:s.target.value}),className:"w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:ring-2 focus:ring-[#2D4485]/20 focus:border-[#2D4485] outline-none",placeholder:"Payment Terms"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery To"}),e.jsx("input",{value:t.details.deliveryTo,onChange:s=>t.setDetails({...t.details,deliveryTo:s.target.value}),className:"w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:ring-2 focus:ring-[#2D4485]/20 focus:border-[#2D4485] outline-none",placeholder:"Delivery To"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-400 p-6 space-y-8 mb-8",children:[e.jsx("h2",{className:"text-xl font-bold text-[#2D4485]",children:"Buyer (EIT)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company"}),e.jsxs("select",{value:t.details.eit||"",onChange:s=>{const i=s.target.value;if(!i){t.setDetails({...t.details,eit:null,eitName:"",eitAddress:"",eitPhone:"",eitFax:"",eitMobile:""});return}const o=t.eitOptions.find(r=>String(r.id)===i);if(o){let r=o.address||"";o.organization_name&&(o.organization_name.toLowerCase().includes("eit lasertechnik")||o.organization_name.toLowerCase().includes("einstein"))&&(r="1/120 ซอยรามคำแหง 184 แขวงมีนบุรี เขตมีนบุรี กรุงเทพมหานคร 10510"),t.setDetails({...t.details,eit:o.id,eitName:o.organization_name,eitAddress:r,eitPhone:o.eit_telephone||"",eitFax:o.eit_fax||"",eitMobile:o.eit_mobile||""})}},className:"w-full rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm focus:ring-2 focus:ring-[#2D4485]/20 focus:border-[#2D4485] outline-none",children:[e.jsx("option",{value:"",children:"Select Organization"}),t.eitOptions.map(s=>e.jsx("option",{value:s.id,children:s.organization_name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("textarea",{value:t.details.eitAddress,onChange:s=>t.setDetails({...t.details,eitAddress:s.target.value}),className:"w-full rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm focus:ring-2 focus:ring-[#2D4485]/20 focus:border-[#2D4485] outline-none",rows:"2",placeholder:"Address"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mobile"}),e.jsx("input",{value:t.details.eitMobile,onChange:s=>t.setDetails({...t.details,eitMobile:s.target.value}),className:"w-full rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm focus:ring-2 focus:ring-[#2D4485]/20 focus:border-[#2D4485] outline-none",placeholder:"Mobile"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telephone"}),e.jsx("input",{value:t.details.eitPhone,onChange:s=>t.setDetails({...t.details,eitPhone:s.target.value}),className:"w-full rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm focus:ring-2 focus:ring-[#2D4485]/20 focus:border-[#2D4485] outline-none",placeholder:"Telephone"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fax"}),e.jsx("input",{value:t.details.eitFax,onChange:s=>t.setDetails({...t.details,eitFax:s.target.value}),className:"w-full rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm focus:ring-2 focus:ring-[#2D4485]/20 focus:border-[#2D4485] outline-none",placeholder:"Fax"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-400 p-6 space-y-8 mb-8",children:[e.jsx("h2",{className:"text-xl font-bold text-[#2D4485]",children:"Vendor Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name"}),e.jsx("input",{value:t.vendor.company,onChange:s=>t.setVendor({...t.vendor,company:s.target.value}),className:"w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:ring-2 focus:ring-[#2D4485]/20 focus:border-[#2D4485] outline-none",placeholder:"Company name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Name"}),e.jsx("input",{value:t.vendor.name,onChange:s=>t.setVendor({...t.vendor,name:s.target.value}),className:"w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:ring-2 focus:ring-[#2D4485]/20 focus:border-[#2D4485] outline-none",placeholder:"Contact name"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telephone"}),e.jsx("input",{value:t.vendor.phone,onChange:s=>t.setVendor({...t.vendor,phone:s.target.value}),className:"w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:ring-2 focus:ring-[#2D4485]/20 focus:border-[#2D4485] outline-none",placeholder:"Telephone"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{value:t.vendor.email,onChange:s=>t.setVendor({...t.vendor,email:s.target.value}),className:"w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:ring-2 focus:ring-[#2D4485]/20 focus:border-[#2D4485] outline-none",placeholder:"Email"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("textarea",{value:t.vendor.address,onChange:s=>t.setVendor({...t.vendor,address:s.target.value}),className:"w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:ring-2 focus:ring-[#2D4485]/20 focus:border-[#2D4485] outline-none",rows:"2",placeholder:"Address"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-400 p-6 mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-[#2D4485]",children:"Items"}),e.jsxs("button",{onClick:t.addItem,className:"inline-flex items-center gap-2 rounded-full px-4 py-2 bg-[#2D4485]/10 text-[#2D4485] hover:bg-[#2D4485]/15",children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Add Item"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:"bg-gray-5 text-[#2D4485] uppercase text-xs font-bold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 border-b w-12",children:"No."}),e.jsx("th",{className:"p-3 border-b",children:"Description"}),e.jsx("th",{className:"p-3 border-b w-24",children:"Qty"}),e.jsx("th",{className:"p-3 border-b w-24",children:"Unit"}),e.jsx("th",{className:"p-3 border-b w-32",children:"Price"}),e.jsx("th",{className:"p-3 border-b w-32",children:"Amount"}),e.jsx("th",{className:"p-3 border-b w-12"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:t.items.map((s,i)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition border-b border-gray-100",children:[e.jsx("td",{className:"p-3 text-center text-sm text-gray-700",children:i+1}),e.jsx("td",{className:"p-3",children:e.jsx("input",{value:s.description,onChange:o=>t.updateItem(i,"description",o.target.value),className:"w-full bg-transparent border-b border-gray-300 px-2 py-1 text-sm focus:border-[#2D4485] outline-none text-gray-700",placeholder:"Description"})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"number",value:s.qty,onChange:o=>t.updateItem(i,"qty",o.target.value),className:"w-full bg-transparent border-b border-gray-300 px-2 py-1 text-sm focus:border-[#2D4485] outline-none text-right"})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{value:s.unit,onChange:o=>t.updateItem(i,"unit",o.target.value),className:"w-full bg-transparent border-b border-gray-300 px-2 py-1 text-sm focus:border-[#2D4485] outline-none text-center"})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"number",value:s.price,onChange:o=>t.updateItem(i,"price",o.target.value),className:"w-full bg-transparent border-b border-gray-300 px-2 py-1 text-sm focus:border-[#2D4485] outline-none text-right"})}),e.jsx("td",{className:"p-3 text-right font-medium",children:((Number(s.qty)||0)*(Number(s.price)||0)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{onClick:()=>t.removeItem(i),className:"text-gray-400 hover:text-red-500 transition-colors",children:e.jsx(G,{className:"w-4 h-4"})})})]},i))})]})}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("div",{className:"w-auto min-w-[250px] space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotal"}),e.jsx("span",{className:"font-medium",children:t.subtotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"VAT (7%)"}),e.jsx("span",{className:"font-medium",children:t.taxTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-3",children:[e.jsx("span",{className:"text-[#2D4485]",children:"Total"}),e.jsx("span",{className:"text-[#2D4485]",children:t.total.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-4 mb-8",children:[e.jsx("button",{onClick:()=>c(!1),className:"px-6 py-2 rounded-lg border border-[#2D4485] text-[#2D4485] hover:bg-[#2D4485]/10 font-medium transition-colors bg-white",children:"Cancel"}),e.jsx("button",{onClick:()=>a(!0),className:"px-6 py-2 rounded-lg bg-[#2D4485] text-white hover:bg-[#3D56A6] font-medium transition-colors shadow-sm",children:"Create PO Form"})]}),h&&e.jsx("div",{className:"fixed inset-0 bg-black/40 z-40",onClick:()=>a(!1),children:e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[560px] max-w-[95vw]",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Create PO Form"}),e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:"Choose how you want to proceed"})]}),e.jsx("button",{className:"text-gray-500 hover:text-gray-900",onClick:()=>a(!1),children:"✕"})]}),e.jsxs("div",{className:"p-4 grid grid-cols-3 gap-4",children:[e.jsx("button",{className:"w-full px-4 py-2 rounded-md border border-[#2D4485] text-[#2D4485] hover:bg-[#2D4485]/10 min-w-[140px]",onClick:()=>{a(!1),c(!1)},children:"Discard"}),e.jsx("button",{className:"w-full px-4 py-2 rounded-md bg-[#2D4485] text-white hover:bg-[#3D56A6] min-w-[140px]",onClick:()=>{a(!1),fe()},children:"Save Changes"}),e.jsx("button",{className:"w-full px-4 py-2 rounded-md text-[#2D4485] underline underline-offset-2 hover:text-[#3D56A6] min-w-[140px] whitespace-nowrap text-center",onClick:()=>{a(!1);const s={poNumber:t.details.poNumber,customer:t.vendor,extraFields:{refQuotation:t.details.refQuotation,orderDate:t.details.orderDate,deliveryDate:t.details.deliveryDate,paymentTerms:t.details.paymentTerms,deliveryTo:t.details.deliveryTo},items:t.items,details:t.details,updatedAt:new Date().toISOString()};ye(s)},children:"Download Form"})]})]})})})]})]}):e.jsxs("div",{className:"h-full",children:[f&&se.createPortal(e.jsxs("div",{id:"print-overlay",className:"fixed inset-0 z-[50] bg-white",children:[e.jsx("style",{children:`
             #print-overlay {
                display: none;
             }
             @media print {
               body {
                 visibility: hidden !important;
               }
               #print-overlay { 
                 visibility: visible !important;
                 display: block !important; 
                 position: absolute !important;
                 top: 0 !important;
                 left: 0 !important;
                 width: 100% !important;
                 height: 100% !important;
                 overflow: visible !important;
                 background: white !important;
                 z-index: 2147483647 !important;
                 padding: 0 !important;
               }
               #print-overlay * {
                 visibility: visible !important;
               }
               #print-overlay .print-content {
                 width: 100% !important;
                 margin: 0 !important;
                 box-shadow: none !important;
               }
               html, body {
                 height: auto !important;
                 overflow: visible !important;
                 background: white !important;
               }
               @page {
                 size: auto;
                 margin: 0mm;
               }
             }
           `}),e.jsx("div",{className:"print-content bg-white p-0 relative",children:e.jsx(re,{q:f})})]}),document.body),e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-6 border-b border-gray-200 mb-6",children:[e.jsxs("button",{onClick:()=>_("po"),className:`pb-3 text-sm font-medium transition-colors relative ${m==="po"?"text-[#2D4485]":"text-gray-500 hover:text-gray-700"}`,children:["Purchase Orders",m==="po"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#2D4485]"})]}),e.jsxs("button",{onClick:()=>_("customer_po"),className:`pb-3 text-sm font-medium transition-colors relative ${m==="customer_po"?"text-[#2D4485]":"text-gray-500 hover:text-gray-700"}`,children:["Customer Purchase Orders",m==="customer_po"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#2D4485]"})]})]}),m==="po"&&e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm p-6 relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[#2D4485]",children:[e.jsx(U,{className:"w-6 h-6"}),e.jsx("h1",{className:"text-xl font-bold",children:"Purchase Orders"})]}),u.length>0&&e.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors text-sm font-medium",children:[e.jsx(G,{className:"w-4 h-4"}),"Delete (",u.length,")"]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("button",{onClick:ge,className:"inline-flex items-center gap-2 px-3 py-2 bg-[#2D4485] text-white rounded-lg hover:bg-[#1E3A8A] transition-colors shadow-sm text-sm font-medium",children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{children:"New PO"})]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 text-gray-700 border-b",children:[e.jsx("th",{className:"p-3 w-10",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-[#2D4485] focus:ring-[#2D4485]/20 h-4 w-4",checked:p.length>0&&u.length===p.length,onChange:xe})}),e.jsx("th",{className:"p-3 text-left w-16",children:"Index"}),e.jsx("th",{className:"p-3 text-left",children:"PO Number"}),e.jsx("th",{className:"p-3 text-left",children:"Vendor"}),e.jsx("th",{className:"p-3 text-left",children:"Order Date"}),e.jsx("th",{className:"p-3 text-left",children:"Delivery Date"}),e.jsx("th",{className:"p-3 text-right",children:"Total Amount"})]})}),e.jsxs("tbody",{className:"divide-y",children:[p.map((s,i)=>{var I,T,O,$;const o=(s.items||[]).reduce((Q,q)=>Q+(Number(q.qty)||0)*(Number(q.price)||0),0),r=o*.07,C=o+r;return e.jsxs("tr",{className:`hover:bg-gray-50 ${u.includes(s.sourceIndex)?"bg-blue-50":""}`,children:[e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-[#2D4485] focus:ring-[#2D4485]/20 h-4 w-4",checked:u.includes(s.sourceIndex),onChange:()=>he(s.sourceIndex)})}),e.jsx("td",{className:"p-3 text-gray-500",children:i+1}),e.jsx("td",{className:"p-3 font-medium",children:e.jsx("button",{onClick:()=>be(i),className:"text-[#2D4485] hover:underline text-left",children:s.poNumber})}),e.jsx("td",{className:"p-3",children:((I=s.customer)==null?void 0:I.company)||((T=s.customer)==null?void 0:T.name)||"-"}),e.jsx("td",{className:"p-3",children:((O=s.extraFields)==null?void 0:O.orderDate)||"-"}),e.jsx("td",{className:"p-3 text-green-600",children:(($=s.extraFields)==null?void 0:$.deliveryDate)||"-"}),e.jsx("td",{className:"p-3 text-right font-medium",children:C.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]},s.sourceIndex)}),p.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"p-8 text-center text-gray-500",children:"No purchase orders found"})})]})]})})]}),m==="customer_po"&&e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm p-6 relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("h1",{className:"text-xl font-bold text-[#2D4485]",children:"Customer Purchase Orders"})}),e.jsxs("button",{onClick:()=>k({}),className:"inline-flex items-center gap-2 px-3 py-2 bg-[#2D4485] text-white rounded-lg hover:bg-[#1E3A8A] transition-colors shadow-sm text-sm font-medium",children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{children:"New Customer PO"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 text-gray-700 border-b",children:[e.jsx("th",{className:"p-3 text-left w-10",children:"No."}),e.jsx("th",{className:"p-3 text-left",children:"Customer Company"}),e.jsx("th",{className:"p-3 text-left",children:"Customer PO Number"}),e.jsx("th",{className:"p-3 text-left",children:"PO Form"}),e.jsx("th",{className:"p-3 w-12"})]})}),e.jsxs("tbody",{className:"divide-y",children:[v&&e.jsxs("tr",{className:"bg-blue-50/50",children:[e.jsx("td",{className:"p-3",children:"-"}),e.jsx("td",{className:"p-3",children:e.jsxs("select",{autoFocus:!0,className:"w-full bg-white border border-gray-300 rounded px-2 py-1",value:v.write_customer_name||"",onChange:s=>k({...v,write_customer_name:s.target.value}),children:[e.jsx("option",{value:"",children:"Select Customer"}),A.map(s=>e.jsx("option",{value:s.company_name,children:s.company_name},s.id))]})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{placeholder:"Customer PO Number",className:"w-full bg-white border border-gray-300 rounded px-2 py-1",value:v.po_number||"",onChange:s=>k({...v,po_number:s.target.value})})}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"cursor-pointer text-blue-600 hover:text-blue-800 text-xs font-medium px-2 py-1 bg-blue-50 rounded border border-blue-100 transition-colors",children:[v.po_file?"File Selected":"Upload File",e.jsx("input",{type:"file",className:"hidden",onChange:s=>k({...v,po_file:s.target.files[0]})})]}),v.po_file&&e.jsx("span",{className:"text-xs text-gray-600 truncate max-w-[150px]",children:v.po_file.name})]})}),e.jsxs("td",{className:"p-3 flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ce(v),className:"text-green-600 hover:text-green-800 font-medium",children:"Save"}),e.jsx("button",{onClick:()=>k(null),className:"text-gray-500 hover:text-gray-700",children:"Cancel"})]})]}),l.map((s,i)=>{var r;const o=J===s.id;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 text-gray-500",children:i+1}),e.jsx("td",{className:"p-3 font-medium text-gray-900",onClick:()=>!o&&ee(s),children:o?e.jsxs("select",{autoFocus:!0,className:"w-full bg-white border border-gray-300 rounded px-2 py-1",value:L.write_customer_name||"",onChange:C=>B({...L,write_customer_name:C.target.value}),children:[e.jsx("option",{value:"",children:"Select Customer"}),A.map(C=>e.jsx("option",{value:C.company_name,children:C.company_name},C.id))]}):e.jsx("div",{className:"cursor-pointer hover:bg-gray-100 rounded px-2 py-1 -ml-2",children:s.customer_name||((r=s.customer_details)==null?void 0:r.company_name)||"-"})}),e.jsx("td",{className:"p-3 text-gray-600",onClick:()=>!o&&ee(s),children:o?e.jsx("input",{className:"w-full bg-white border border-gray-300 rounded px-2 py-1",value:L.po_number||"",onChange:C=>B({...L,po_number:C.target.value})}):e.jsx("div",{className:"cursor-pointer hover:bg-gray-100 rounded px-2 py-1 -ml-2",children:s.po_number||"-"})}),e.jsx("td",{className:"p-3",children:e.jsx("div",{className:"flex items-center gap-3",children:s.po_file_name?e.jsxs(e.Fragment,{children:[e.jsx("a",{href:`${S}/api/customer_purchase_orders/${s.id}/download/`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline font-medium text-sm truncate max-w-[200px]",children:s.po_file_name}),e.jsxs("label",{className:"cursor-pointer text-blue-600 hover:text-blue-800 text-xs font-medium px-2 py-1 bg-blue-50 rounded border border-blue-100 transition-colors",children:["Replace",e.jsx("input",{type:"file",className:"hidden",onChange:C=>Z(s.id,C.target.files[0])})]})]}):e.jsxs("label",{className:"cursor-pointer text-blue-600 hover:text-blue-800 text-xs font-medium px-2 py-1 bg-blue-50 rounded border border-blue-100 transition-colors",children:["Upload",e.jsx("input",{type:"file",className:"hidden",onChange:C=>Z(s.id,C.target.files[0])})]})})}),e.jsx("td",{className:"p-3 text-center",children:o?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:ue,className:"text-green-600 hover:text-green-800 text-xs font-medium",children:"Save"}),e.jsx("button",{onClick:()=>H(null),className:"text-gray-500 hover:text-gray-700 text-xs",children:"Cancel"})]}):e.jsx("button",{onClick:()=>de(s.id),className:"text-gray-400 hover:text-red-500 transition-colors",children:e.jsx(G,{className:"w-4 h-4"})})})]},s.id)}),!v&&l.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-8 text-center text-gray-500",children:"No customer purchase orders found"})})]})]})})]})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/30 z-50 flex items-center justify-center p-4",onClick:()=>g(!1),children:e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 w-full max-w-sm",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Delete Purchase Orders"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Are you sure you want to delete ",u.length," selected purchase orders?"]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>g(!1),className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-medium",children:"Cancel"}),e.jsx("button",{onClick:pe,className:"px-4 py-2 bg-red-600 text-white hover:bg-red-700 rounded-lg transition-colors font-medium",children:"Delete"})]})]})})}),P&&e.jsx("div",{className:"fixed inset-0 bg-black/30 z-50 flex items-center justify-center p-4",onClick:()=>F(null),children:e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 w-full max-w-sm",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Delete Purchase Orders"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to delete 1 selected purchase orders?"}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>F(null),className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-medium",children:"Cancel"}),e.jsx("button",{onClick:me,className:"px-4 py-2 bg-red-600 text-white hover:bg-red-700 rounded-lg transition-colors font-medium",children:"Delete"})]})]})})})]})}const Te=()=>{const t={quotations:[],invoices:[],billingNotes:[],customers:[],purchaseOrders:[]};try{try{const n=JSON.parse(localStorage.getItem("poList")||"[]");Array.isArray(n)&&(t.purchaseOrders=n)}catch(n){console.error("Error parsing poList",n)}for(let n=0;n<localStorage.length;n++){const x=localStorage.key(n);if(x&&x.startsWith("history:"))try{const c=JSON.parse(localStorage.getItem(x));c&&(c.customer&&t.customers.push(c.customer),Array.isArray(c.quotations)&&c.quotations.forEach((f,y)=>{var D,j;t.quotations.push({...f,customerName:((D=c.customer)==null?void 0:D.name)||((j=c.customer)==null?void 0:j.company),sourceKey:x,sourceIndex:y})}),Array.isArray(c.billingNotes)&&c.billingNotes.forEach((f,y)=>{var D,j;t.billingNotes.push({...f,customerName:((D=c.customer)==null?void 0:D.name)||((j=c.customer)==null?void 0:j.company),sourceKey:x,sourceIndex:y})}),Array.isArray(c.invoices)&&c.invoices.forEach((f,y)=>{var D,j;t.invoices.push({...f,customerName:((D=c.customer)==null?void 0:D.name)||((j=c.customer)==null?void 0:j.company),sourceKey:x,sourceIndex:y})}))}catch(c){console.error("Error parsing key",x,c)}}}catch(n){console.error("Error accessing localStorage",n)}const p=n=>{const x={};return n.forEach(c=>{var y,D,j,h;const f=(D=(y=c.details)==null?void 0:y.number)==null?void 0:D.trim();if(f){const a=x[f],u=new Date(c.savedAt||((j=c.details)==null?void 0:j.date)||0),w=a?new Date(a.savedAt||((h=a.details)==null?void 0:h.date)||0):new Date(0);(!a||u>w)&&(x[f]=c)}}),Object.values(x)};return t.invoices=p(t.invoices),t.quotations=p(t.quotations),t.billingNotes=p(t.billingNotes),t.quotations.sort((n,x)=>{var f,y;const c=D=>{const j=(D||"").match(/QT[-/ ]?(\d+)/i);return j?parseInt(j[1],10):0};return c((f=n.details)==null?void 0:f.number)-c((y=x.details)==null?void 0:y.number)}),t.invoices.sort((n,x)=>{var c,f;return new Date(x.savedAt||((c=x.details)==null?void 0:c.date))-new Date(n.savedAt||((f=n.details)==null?void 0:f.date))}),t.billingNotes.sort((n,x)=>{var c,f;return new Date(x.savedAt||((c=x.details)==null?void 0:c.date))-new Date(n.savedAt||((f=n.details)==null?void 0:f.date))}),t.purchaseOrders.sort((n,x)=>{var c,f;return new Date(x.updatedAt||((c=x.extraFields)==null?void 0:c.orderDate))-new Date(n.updatedAt||((f=n.extraFields)==null?void 0:f.orderDate))}),t};function Oe({data:t}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-gray-500 text-sm font-medium",children:"Purchase Orders"}),e.jsx("div",{className:"p-2 bg-orange-50 rounded-lg",children:e.jsx(U,{className:"w-5 h-5 text-orange-600"})})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t.purchaseOrders.length})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-gray-500 text-sm font-medium",children:"Total Quotations"}),e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(z,{className:"w-5 h-5 text-blue-600"})})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t.quotations.length})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-gray-500 text-sm font-medium",children:"Total Invoices"}),e.jsx("div",{className:"p-2 bg-green-50 rounded-lg",children:e.jsx(W,{className:"w-5 h-5 text-green-600"})})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t.invoices.length})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-gray-500 text-sm font-medium",children:"Billing Notes"}),e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(z,{className:"w-5 h-5 text-blue-600"})})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:t.billingNotes.length})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Recent Purchase Orders"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[e.jsx("th",{className:"pb-2",children:"PO Number"}),e.jsx("th",{className:"pb-2",children:"Vendor"}),e.jsx("th",{className:"pb-2",children:"Items"}),e.jsx("th",{className:"pb-2 text-right",children:"Total Amount"})]})}),e.jsxs("tbody",{className:"divide-y",children:[t.purchaseOrders.slice(0,5).map((p,n)=>{var c,f,y;const x=(p.items||[]).reduce((D,j)=>D+(Number(j.qty)||0)*(Number(j.price)||0),0)*1.07;return e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 font-medium",children:p.poNumber}),e.jsx("td",{className:"py-3",children:((c=p.customer)==null?void 0:c.company)||((f=p.customer)==null?void 0:f.name)||"-"}),e.jsx("td",{className:"py-3",children:((y=p.items)==null?void 0:y.length)||0}),e.jsxs("td",{className:"py-3 text-right",children:["THB ",x.toFixed(2)]})]},n)}),t.purchaseOrders.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"py-4 text-center text-gray-500",children:"No purchase orders found"})})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Recent Quotations"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[e.jsx("th",{className:"pb-2",children:"QT Code"}),e.jsx("th",{className:"pb-2",children:"Customer"}),e.jsx("th",{className:"pb-2",children:"Date"}),e.jsx("th",{className:"pb-2 text-right",children:"Amount"})]})}),e.jsxs("tbody",{className:"divide-y",children:[[...t.quotations].sort((p,n)=>{var x,c;return new Date(n.savedAt||((x=n.details)==null?void 0:x.date))-new Date(p.savedAt||((c=p.details)==null?void 0:c.date))}).slice(0,5).map((p,n)=>{var x,c,f,y,D;return e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 font-medium",children:(x=p.details)==null?void 0:x.number}),e.jsx("td",{className:"py-3",children:p.customerName||"-"}),e.jsx("td",{className:"py-3",children:(c=p.details)==null?void 0:c.date}),e.jsxs("td",{className:"py-3 text-right",children:[(f=p.details)==null?void 0:f.currency," ",(D=(y=p.totals)==null?void 0:y.total)==null?void 0:D.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]},n)}),t.quotations.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"py-4 text-center text-gray-500",children:"No quotations found"})})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Recent Invoices"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[e.jsx("th",{className:"pb-2",children:"Invoice Number"}),e.jsx("th",{className:"pb-2",children:"Customer"}),e.jsx("th",{className:"pb-2",children:"Due Date"}),e.jsx("th",{className:"pb-2 text-right",children:"Amount"})]})}),e.jsxs("tbody",{className:"divide-y",children:[t.invoices.slice(0,5).map((p,n)=>{var x,c,f,y,D;return e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 font-medium",children:(x=p.details)==null?void 0:x.number}),e.jsx("td",{className:"py-3",children:p.customerName||"-"}),e.jsx("td",{className:"py-3",children:(c=p.details)==null?void 0:c.dueDate}),e.jsxs("td",{className:"py-3 text-right",children:[(f=p.details)==null?void 0:f.currency," ",(D=(y=p.totals)==null?void 0:y.total)==null?void 0:D.toFixed(2)]})]},n)}),t.invoices.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"py-4 text-center text-gray-500",children:"No invoices found"})})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Recent Billing Notes"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[e.jsx("th",{className:"pb-2",children:"Billing Note Number"}),e.jsx("th",{className:"pb-2",children:"Customer"}),e.jsx("th",{className:"pb-2",children:"Due Date"}),e.jsx("th",{className:"pb-2 text-right",children:"Amount"})]})}),e.jsxs("tbody",{className:"divide-y",children:[t.billingNotes.slice(0,5).map((p,n)=>{var x,c,f,y,D;return e.jsxs("tr",{children:[e.jsx("td",{className:"py-3 font-medium",children:(x=p.details)==null?void 0:x.number}),e.jsx("td",{className:"py-3",children:p.customerName||"-"}),e.jsx("td",{className:"py-3",children:(c=p.details)==null?void 0:c.dueDate}),e.jsxs("td",{className:"py-3 text-right",children:[(f=p.details)==null?void 0:f.currency," ",(D=(y=p.totals)==null?void 0:y.total)==null?void 0:D.toFixed(2)]})]},n)}),t.billingNotes.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"py-4 text-center text-gray-500",children:"No billing notes found"})})]})]})})]})]})]})}function Ee({list:t,refreshData:p}){const[n,x]=N.useState([]),[c,f]=N.useState(!1),y=a=>`${a.sourceKey}-${a.sourceIndex}`,D=a=>{a.target.checked?x(t.map(y)):x([])},j=a=>{n.includes(a)?x(u=>u.filter(w=>w!==a)):x(u=>[...u,a])},h=async()=>{const a=t.filter(g=>n.includes(y(g))),u=a.filter(g=>g.sourceKey==="api");for(const g of u)try{await fetch(`${S}/api/quotations/${g.id}/`,{method:"DELETE"})}catch(m){console.error("Error deleting API item",m)}const w=a.filter(g=>g.sourceKey!=="api"),d={};w.forEach(g=>{d[g.sourceKey]||(d[g.sourceKey]=[]),d[g.sourceKey].push(g.sourceIndex)}),Object.keys(d).forEach(g=>{try{const m=JSON.parse(localStorage.getItem(g));if(m&&Array.isArray(m.quotations)){const _=d[g];m.quotations=m.quotations.filter((l,b)=>!_.includes(b)),localStorage.setItem(g,JSON.stringify(m))}}catch(m){console.error("Error updating localStorage",m)}}),p&&p(),x([]),f(!1)};return e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm p-6 relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[#2D4485]",children:[e.jsx(le,{className:"w-6 h-6"}),e.jsx("h1",{className:"text-xl font-bold",children:"Quotations"})]}),n.length>0&&e.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors text-sm font-medium",children:[e.jsx(X,{className:"w-4 h-4"}),"Delete (",n.length,")"]})]}),e.jsxs("a",{href:"/quotation.html",className:"flex items-center gap-2 px-4 py-2 bg-[#2D4485] text-white rounded-lg hover:bg-[#1e2f5c] transition-colors text-sm font-medium",children:[e.jsx(K,{className:"w-4 h-4"}),"New Quotation"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 text-gray-700 border-b",children:[e.jsx("th",{className:"p-3 w-10",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-[#2D4485] focus:ring-[#2D4485]/20 h-4 w-4",checked:t.length>0&&n.length===t.length,onChange:D})}),e.jsx("th",{className:"p-3 text-left w-16",children:"Index"}),e.jsx("th",{className:"p-3 text-left",children:"Quotation Number"}),e.jsx("th",{className:"p-3 text-left",children:"Customer"}),e.jsx("th",{className:"p-3 text-left",children:"Date"}),e.jsx("th",{className:"p-3 text-left",children:"Item"}),e.jsx("th",{className:"p-3 text-right",children:"Grand Total"})]})}),e.jsxs("tbody",{className:"divide-y",children:[t.map((a,u)=>{var d,g,m,_,l,b;const w=y(a);return e.jsxs("tr",{className:`hover:bg-gray-50 ${n.includes(w)?"bg-blue-50":""}`,children:[e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-[#2D4485] focus:ring-[#2D4485]/20 h-4 w-4",checked:n.includes(w),onChange:()=>j(w)})}),e.jsx("td",{className:"p-3 text-gray-500",children:u+1}),e.jsx("td",{className:"p-3 font-medium",children:e.jsx("a",{href:`/quotation.html?key=${encodeURIComponent(a.sourceKey)}&index=${a.sourceIndex}`,className:"text-[#2D4485] hover:underline",children:(d=a.details)==null?void 0:d.number})}),e.jsx("td",{className:"p-3",children:a.customerName||"-"}),e.jsx("td",{className:"p-3",children:(g=a.details)==null?void 0:g.date}),e.jsx("td",{className:"p-3",children:((m=a.items)==null?void 0:m.length)||0}),e.jsxs("td",{className:"p-3 text-right font-medium",children:[(_=a.details)==null?void 0:_.currency," ",(b=(l=a.totals)==null?void 0:l.total)==null?void 0:b.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]},w)}),t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-8 text-center text-gray-500",children:"No quotations found"})})]})]})}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/30 z-50 flex items-center justify-center p-4",onClick:()=>f(!1),children:e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 w-full max-w-sm",onClick:a=>a.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Delete Quotations"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Are you sure you want to delete ",n.length," selected quotations?"]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-medium",children:"Cancel"}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-red-600 text-white hover:bg-red-700 rounded-lg transition-colors font-medium",children:"Delete"})]})]})})})]})}function $e({list:t,refreshData:p}){const[n,x]=N.useState([]),[c,f]=N.useState(!1),y=a=>`${a.sourceKey}-${a.sourceIndex}`,D=a=>{a.target.checked?x(t.map(y)):x([])},j=a=>{n.includes(a)?x(u=>u.filter(w=>w!==a)):x(u=>[...u,a])},h=async()=>{const a=t.filter(_=>n.includes(y(_))),u=a.filter(_=>_.sourceKey==="api");let w=0,d=0;for(const _ of u)try{const l=localStorage.getItem("authToken"),b={"Content-Type":"application/json"};l&&(b.Authorization=`Token ${l}`);const v=await fetch(`${S}/api/invoices/${_.id}/`,{method:"DELETE",headers:b});v.ok?w++:(console.error(`Failed to delete invoice ${_.id}:`,v.status),d++)}catch(l){console.error("Error deleting API item",l),d++}d>0&&alert(`Deleted ${w} items. Failed to delete ${d} items. Please check permissions or network.`);const g=a.filter(_=>_.sourceKey!=="api"),m={};g.forEach(_=>{m[_.sourceKey]||(m[_.sourceKey]=[]),m[_.sourceKey].push(_.sourceIndex)}),Object.keys(m).forEach(_=>{try{const l=JSON.parse(localStorage.getItem(_));if(l&&Array.isArray(l.invoices)){const b=m[_];l.invoices=l.invoices.filter((v,k)=>!b.includes(k)),localStorage.setItem(_,JSON.stringify(l))}}catch(l){console.error("Error updating localStorage",l)}}),p&&await p(),x([]),f(!1)};return e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm p-6 relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[#2D4485]",children:[e.jsx(W,{className:"w-6 h-6"}),e.jsx("h1",{className:"text-xl font-bold",children:"Invoices"})]}),n.length>0&&e.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors text-sm font-medium",children:[e.jsx(X,{className:"w-4 h-4"}),"Delete (",n.length,")"]})]}),e.jsxs("a",{href:"/invoice.html",className:"flex items-center gap-2 px-4 py-2 bg-[#2D4485] text-white rounded-lg hover:bg-[#1e2f5c] transition-colors text-sm font-medium",children:[e.jsx(K,{className:"w-4 h-4"}),"New Invoice"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 text-gray-700 border-b",children:[e.jsx("th",{className:"p-3 w-10",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-[#2D4485] focus:ring-[#2D4485]/20 h-4 w-4",checked:t.length>0&&n.length===t.length,onChange:D})}),e.jsx("th",{className:"p-3 text-left w-16",children:"Index"}),e.jsx("th",{className:"p-3 text-left",children:"Invoice Number"}),e.jsx("th",{className:"p-3 text-left",children:"Customer"}),e.jsx("th",{className:"p-3 text-left",children:"Date"}),e.jsx("th",{className:"p-3 text-left",children:"Due Date"}),e.jsx("th",{className:"p-3 text-right",children:"Total"})]})}),e.jsxs("tbody",{className:"divide-y",children:[t.map((a,u)=>{var d,g,m,_,l,b;const w=y(a);return e.jsxs("tr",{className:`hover:bg-gray-50 ${n.includes(w)?"bg-blue-50":""}`,children:[e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-[#2D4485] focus:ring-[#2D4485]/20 h-4 w-4",checked:n.includes(w),onChange:()=>j(w)})}),e.jsx("td",{className:"p-3 text-gray-500",children:u+1}),e.jsx("td",{className:"p-3 font-medium",children:e.jsx("a",{href:`/invoice.html?key=${encodeURIComponent(a.sourceKey)}&index=${a.sourceIndex}`,className:"text-[#2D4485] hover:underline",children:(d=a.details)==null?void 0:d.number})}),e.jsx("td",{className:"p-3",children:a.customerName||"-"}),e.jsx("td",{className:"p-3",children:(g=a.details)==null?void 0:g.date}),e.jsx("td",{className:"p-3 text-red-600",children:(m=a.details)==null?void 0:m.dueDate}),e.jsxs("td",{className:"p-3 text-right font-medium",children:[(_=a.details)==null?void 0:_.currency," ",(b=(l=a.totals)==null?void 0:l.total)==null?void 0:b.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]},w)}),t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"p-8 text-center text-gray-500",children:"No invoices found"})})]})]})}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/30 z-50 flex items-center justify-center p-4",onClick:()=>f(!1),children:e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 w-full max-w-sm",onClick:a=>a.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Delete Invoices"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Are you sure you want to delete ",n.length," selected invoices?"]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-medium",children:"Cancel"}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-red-600 text-white hover:bg-red-700 rounded-lg transition-colors font-medium",children:"Delete"})]})]})})})]})}function Fe({list:t,refreshData:p}){const[n,x]=N.useState([]),[c,f]=N.useState(!1),y=a=>`${a.sourceKey}-${a.sourceIndex}`,D=a=>{a.target.checked?x(t.map(y)):x([])},j=a=>{n.includes(a)?x(u=>u.filter(w=>w!==a)):x(u=>[...u,a])},h=async()=>{const a=t.filter(g=>n.includes(y(g))),u=a.filter(g=>g.sourceKey==="api");for(const g of u)try{await fetch(`${S}/api/billing_notes/${g.id}/`,{method:"DELETE"})}catch(m){console.error("Error deleting API item",m)}const w=a.filter(g=>g.sourceKey!=="api"),d={};w.forEach(g=>{d[g.sourceKey]||(d[g.sourceKey]=[]),d[g.sourceKey].push(g.sourceIndex)}),Object.keys(d).forEach(g=>{try{const m=JSON.parse(localStorage.getItem(g));if(m&&Array.isArray(m.billingNotes)){const _=d[g];m.billingNotes=m.billingNotes.filter((l,b)=>!_.includes(b)),localStorage.setItem(g,JSON.stringify(m))}}catch(m){console.error("Error updating localStorage",m)}}),p&&p(),x([]),f(!1)};return e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm p-6 relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[#2D4485]",children:[e.jsx(z,{className:"w-6 h-6"}),e.jsx("h1",{className:"text-xl font-bold",children:"Billing Notes"})]}),n.length>0&&e.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors text-sm font-medium",children:[e.jsx(X,{className:"w-4 h-4"}),"Delete (",n.length,")"]})]}),e.jsxs("a",{href:"/billing-note.html",className:"flex items-center gap-2 px-4 py-2 bg-[#2D4485] text-white rounded-lg hover:bg-[#1e2f5c] transition-colors text-sm font-medium",children:[e.jsx(K,{className:"w-4 h-4"}),"New Billing Note"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 text-gray-700 border-b",children:[e.jsx("th",{className:"p-3 w-10",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-[#2D4485] focus:ring-[#2D4485]/20 h-4 w-4",checked:t.length>0&&n.length===t.length,onChange:D})}),e.jsx("th",{className:"p-3 text-left w-16",children:"Index"}),e.jsx("th",{className:"p-3 text-left",children:"Billing Note Number"}),e.jsx("th",{className:"p-3 text-left",children:"Customer"}),e.jsx("th",{className:"p-3 text-left",children:"Due Date"}),e.jsx("th",{className:"p-3 text-right",children:"Amount"}),e.jsx("th",{className:"p-3 text-right",children:"Outstanding"})]})}),e.jsxs("tbody",{className:"divide-y",children:[t.map((a,u)=>{var _,l,b,v;const w=y(a),d=(a.items||[]).reduce((k,A)=>k+(Number(String(A.amount).replace(/,/g,""))||0),0),g=(a.items||[]).reduce((k,A)=>k+(Number(String(A.paid).replace(/,/g,""))||0),0),m=d-g;return e.jsxs("tr",{className:`hover:bg-gray-50 ${n.includes(w)?"bg-blue-50":""}`,children:[e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-[#2D4485] focus:ring-[#2D4485]/20 h-4 w-4",checked:n.includes(w),onChange:()=>j(w)})}),e.jsx("td",{className:"p-3 text-gray-500",children:u+1}),e.jsx("td",{className:"p-3 font-medium",children:e.jsx("a",{href:`/billing-note.html?key=${encodeURIComponent(a.sourceKey)}&index=${a.sourceIndex}`,className:"text-[#2D4485] hover:underline",children:(_=a.details)==null?void 0:_.number})}),e.jsx("td",{className:"p-3",children:a.customerName||"-"}),e.jsx("td",{className:"p-3 text-red-600",children:(l=a.details)==null?void 0:l.dueDate}),e.jsxs("td",{className:"p-3 text-right font-medium text-blue-600",children:[(b=a.details)==null?void 0:b.currency," ",d.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("td",{className:`p-3 text-right font-medium ${m>0?"text-red-600":"text-green-600"}`,children:[(v=a.details)==null?void 0:v.currency," ",m.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]},w)}),t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"p-8 text-center text-gray-500",children:"No billing notes found"})})]})]})}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/30 z-50 flex items-center justify-center p-4",onClick:()=>f(!1),children:e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 w-full max-w-sm",onClick:a=>a.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Delete Billing Notes"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Are you sure you want to delete ",n.length," selected billing notes?"]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors font-medium",children:"Cancel"}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-red-600 text-white hover:bg-red-700 rounded-lg transition-colors font-medium",children:"Delete"})]})]})})})]})}function Le(){const[t,p]=N.useState([]),[n,x]=N.useState(!1),[c,f]=N.useState(null),y=["Manufacturing","Inventory","CRM","Project Management","Admin","Support"],D=l=>l?l==="all"?[...y]:l.split(",").map(b=>b.trim()).filter(Boolean):[],[j,h]=N.useState(null),a=N.useCallback(async()=>{try{const l=localStorage.getItem("authToken"),b=localStorage.getItem("currentUser");let v=null;try{v=JSON.parse(b||"{}")}catch{}if(!v||!v.email&&!v.name){h(null);return}let k=localStorage.getItem("allowedApps");if(l)try{const E=await fetch(`${S}/api/auth/me/allowed-apps/`,{headers:{Authorization:`Token ${l}`}});if(E.ok){const P=await E.json();typeof P.allowed_apps=="string"&&(k=P.allowed_apps,localStorage.setItem("allowedApps",P.allowed_apps))}}catch{}const A=localStorage.getItem("userRole");h({id:null,email:v.email||"",name:v.name||"",is_staff:A==="Admin",allowed_apps:k||""})}catch{h(null)}},[]),u=N.useCallback(async()=>{try{x(!0);const l=localStorage.getItem("authToken");if(!l){p([]),x(!1);return}const b=await fetch(`${S}/api/users/`,{headers:{Authorization:`Token ${l}`}});if(b.ok){const v=await b.json();p(Array.isArray(v)?v:[])}else p([])}catch{p([])}finally{x(!1)}},[]);N.useEffect(()=>{a(),u()},[u,a]),N.useEffect(()=>{if(j&&!j.id&&t.length){const l=t.find(b=>j.email&&b.email===j.email);l&&h({...j,id:l.id,allowed_apps:l.allowed_apps??j.allowed_apps,is_staff:l.is_staff})}},[t,j]);const w=(l,b)=>D(l).includes(b),d=async(l,b)=>{try{f(l);const v=localStorage.getItem("authToken");if(!v)return;console.log(`Saving permissions for user ${l}: ${b}`);const k=await fetch(`${S}/api/users/permissions/`,{method:"POST",headers:{Authorization:`Token ${v}`,"Content-Type":"application/json"},body:JSON.stringify({user_id:l,allowed_apps:b})});k.ok?console.log("Permissions saved successfully"):(console.error("Failed to save permissions",k.status,await k.text()),alert("Failed to save permissions. Please try again."),await u())}catch(v){console.error("Error saving permissions",v),alert("Error saving permissions: "+v.message),await u()}finally{f(null)}},g=(l,b)=>{const v=t.find(P=>P.id===l);if(!v)return;const k=D(v.allowed_apps||"");let A=[];k.includes(b)?A=k.filter(P=>P!==b):A=[...k,b];const E=A.length===y.length?"all":A.length?A.join(","):"";p(P=>P.map(F=>F.id===l?{...F,allowed_apps:E}:F)),j&&j.id===l&&h(P=>({...P,allowed_apps:E})),d(l,E)},m=l=>{const b="all";p(v=>v.map(k=>k.id===l?{...k,allowed_apps:b}:k)),j&&j.id===l&&h(v=>({...v,allowed_apps:b})),d(l,b)},_=l=>{const b="";p(v=>v.map(k=>k.id===l?{...k,allowed_apps:b}:k)),j&&j.id===l&&h(v=>({...v,allowed_apps:b})),d(l,b)};return e.jsxs("div",{className:"bg-white rounded-xl border shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"User Permissions"}),e.jsx("button",{onClick:u,className:"px-3 py-2 text-sm rounded-lg border border-gray-300 bg-gray-100 hover:bg-gray-200",children:"Refresh"})]}),n?e.jsx("div",{className:"py-6 text-center text-gray-500",children:"Loading users..."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 text-gray-700 border-b",children:[e.jsx("th",{className:"p-3 text-left",children:"User"}),e.jsx("th",{className:"p-3 text-left",children:"Role"}),e.jsx("th",{className:"p-3 text-left",children:"Allowed Apps"}),e.jsx("th",{className:"p-3 text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y",children:[[...j?[j]:[],...t.filter(l=>!j||l.email!==j.email)].map(l=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"p-3",children:[e.jsx("div",{className:"font-medium text-gray-900",children:j&&l.email===j.email?"You":l.name}),e.jsx("div",{className:"text-xs text-gray-500",children:l.email})]}),e.jsx("td",{className:"p-3",children:l.is_staff?"Admin":"User"}),e.jsx("td",{className:"p-3",children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:y.map(b=>e.jsxs("label",{className:"inline-flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:w(l.allowed_apps,b),onChange:()=>g(l.id,b)}),e.jsx("span",{children:b})]},b))})}),e.jsx("td",{className:"p-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>m(l.id),className:"px-2 py-1 text-xs rounded border border-gray-300",children:"All"}),e.jsx("button",{onClick:()=>_(l.id),className:"px-2 py-1 text-xs rounded border border-gray-300",children:"None"}),e.jsx("button",{onClick:()=>d(l.id,l.allowed_apps),className:`px-3 py-1.5 text-xs rounded bg-[#2D4485] text-white ${c===l.id?"opacity-50":""}`,disabled:!l.id||c===l.id,children:"Save"}),c===l.id&&e.jsx("span",{className:"text-xs text-gray-500",children:"Saving..."})]})})]},l.id)),t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"p-8 text-center text-gray-500",children:"No users available"})})]})]})})]})}function Re(){const[t,p]=N.useState("dashboard"),[n,x]=N.useState({quotations:[],invoices:[],billingNotes:[],customers:[],purchaseOrders:[]}),c=async()=>{try{const h=localStorage.getItem("authToken"),a=h?{Authorization:`Token ${h}`}:{},u=await fetch(`${S}/api/quotations/`,{headers:a});if(u.ok)return(await u.json()).map(d=>{var g;return{id:d.id,sourceKey:"api",sourceIndex:d.id,details:{number:d.qo_code,date:d.created_date,currency:d.currency||"THB"},customerName:((g=d.customer_details)==null?void 0:g.company_name)||"Unknown",items:d.quotation_items||[],totals:{total:(d.quotation_items||[]).reduce((m,_)=>m+parseFloat(_.quo_total||0),0)}}})}catch(h){console.error("Failed to fetch quotations from API",h)}return[]},f=async()=>{try{const h=localStorage.getItem("authToken"),a=h?{Authorization:`Token ${h}`}:{},u=await fetch(`${S}/api/billing_notes/`,{headers:a});if(u.ok)return(await u.json()).map(d=>{var g;return{id:d.id,sourceKey:"api",sourceIndex:d.id,details:{number:d.bn_code,date:d.bn_created_date||d.bn_date,dueDate:d.bn_due_date||d.bn_invoice_date,currency:d.bn_currency||"THB"},customerName:((g=d.customer_details)==null?void 0:g.company_name)||d.customer_name||"Unknown",items:(d.items||[]).map(m=>({...m,invoiceNo:m.invoice_no||m.invoiceNo,dueDate:m.due_date||m.dueDate,amount:m.amount,paid:m.paid})),totals:{total:(d.items||[]).reduce((m,_)=>m+(parseFloat(String(_.amount||0).replace(/,/g,""))-parseFloat(String(_.paid||0).replace(/,/g,""))),0)}}})}catch(h){console.error("Failed to fetch billing notes from API",h)}return[]},y=async()=>{try{const h=localStorage.getItem("authToken"),a=h?{Authorization:`Token ${h}`}:{},u=await fetch(`${S}/api/invoices/`,{headers:a});if(u.ok)return(await u.json()).map(d=>{var g,m,_,l,b,v;return{id:d.id,sourceKey:"api",sourceIndex:d.id,details:{...d.details,number:d.number,date:((g=d.details)==null?void 0:g.date)||d.created_at,currency:((m=d.details)==null?void 0:m.currency)||"THB"},customerName:((_=d.customer)==null?void 0:_.company)||((l=d.customer)==null?void 0:l.company_name)||((b=d.customer)==null?void 0:b.name)||"Unknown",items:d.items||[],totals:{total:((v=d.totals)==null?void 0:v.total)||0}}})}catch(h){console.error("Failed to fetch invoices from API",h)}return[]},D=async()=>{try{const h=await fetch(`${S}/api/purchase_orders/`);if(h.ok)return(await h.json()).map(u=>{var w,d,g,m,_;return{poNumber:u.number,customer:u.customer,items:u.items,details:{poNumber:u.number,eit:((w=u.eit_details)==null?void 0:w.id)||u.eit,eitName:((d=u.extra_fields)==null?void 0:d.eitName)||((g=u.eit_details)==null?void 0:g.organization_name)||"",eitAddress:((m=u.extra_fields)==null?void 0:m.eitAddress)||((_=u.eit_details)==null?void 0:_.address)||"",...u.extra_fields},extraFields:u.extra_fields,updatedAt:u.updated_at,sourceKey:"api",sourceIndex:u.id}})}catch(h){console.error("Failed to fetch POs from API",h)}return null},j=async()=>{const h=Te(),a=await c(),u=await f(),w=await y(),d=await D();if(d!==null&&(h.purchaseOrders=d),a.length>0){const g=new Set(a.map(m=>m.details.number));h.quotations=h.quotations.filter(m=>!g.has(m.details.number)),h.quotations=[...h.quotations,...a]}if(u.length>0){const g=new Set(u.map(m=>m.details.number));h.billingNotes=h.billingNotes.filter(m=>!g.has(m.details.number)),h.billingNotes=[...h.billingNotes,...u]}if(w.length>0){const g=new Set(w.map(m=>m.details.number));h.invoices=h.invoices.filter(m=>!g.has(m.details.number)),h.invoices=[...h.invoices,...w]}x(h)};return N.useEffect(()=>{const h="history:Mock Customer 002";if(!localStorage.getItem(h)){const a={customer:{company:"Mock Customer 002",taxId:"0000000000002",address:"456 Another Road, Bangkok",telephone:"02-999-9999",email:"customer002@example.com",contactPerson:"Jane Doe"},quotations:[{details:{number:"QT-002",date:new Date().toISOString().slice(0,10),currency:"THB",validUntil:"",salesPerson:"Admin",paymentTerms:"30 Days",remark:"Mock data 002"},items:[{item:"1",model:"MODEL-002",description:"Test Product 002",qty:2,price:2500}],totals:{total:5350}}],invoices:[{details:{number:`VOI ${new Date().getFullYear()}-0002`,date:new Date().toISOString().slice(0,10),dueDate:new Date(Date.now()+2592e6).toISOString().slice(0,10),currency:"THB",sourceQuotationNumber:"QT-002"},items:[{product:"MODEL-002",description:"Test Product 002",qty:2,price:2500,unit:"pcs"}],totals:{total:5350}}],billingNotes:[{details:{number:"BN-002",date:new Date().toISOString().slice(0,10),dueDate:new Date(Date.now()+2592e6).toISOString().slice(0,10),currency:"THB"},items:[{product:"MODEL-002",description:"Test Product 002",qty:2,price:2500,unit:"pcs"}],totals:{total:5350}}]};localStorage.setItem(h,JSON.stringify(a)),j()}},[]),N.useEffect(()=>{j()},[t]),N.useEffect(()=>{const a=new URLSearchParams(window.location.search).get("view");a==="customerHistory"&&p("customers"),a==="purchaseOrders"&&p("purchase-orders")},[]),e.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[e.jsxs("aside",{className:"w-64 bg-white border-r hidden lg:block fixed top-16 bottom-0 overflow-y-auto pt-4",children:[e.jsx("div",{className:"px-6 mb-8",children:e.jsx("h2",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Admin Panel"})}),e.jsxs("nav",{className:"space-y-1 px-3",children:[e.jsxs("button",{onClick:()=>p("dashboard"),className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-lg transition-colors ${t==="dashboard"?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(Ae,{className:"w-5 h-5"}),"Dashboard"]}),e.jsxs("button",{onClick:()=>p("purchase-orders"),className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-lg transition-colors ${t==="purchase-orders"?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(U,{className:"w-5 h-5"}),"Purchase Orders"]}),e.jsxs("button",{onClick:()=>p("quotations"),className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-lg transition-colors ${t==="quotations"?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(le,{className:"w-5 h-5"}),"Quotations"]}),e.jsxs("button",{onClick:()=>p("invoices"),className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-lg transition-colors ${t==="invoices"?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(W,{className:"w-5 h-5"}),"Invoices"]}),e.jsxs("button",{onClick:()=>p("billing-notes"),className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-lg transition-colors ${t==="billing-notes"?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(z,{className:"w-5 h-5"}),"Billing Notes"]}),e.jsxs("button",{onClick:()=>p("permissions"),className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-lg transition-colors ${t==="permissions"?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(ve,{className:"w-5 h-5"}),"User Permissions"]})]})]}),e.jsxs("main",{className:"flex-1 lg:ml-64 p-8",children:[e.jsx("header",{className:"mb-8",children:e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:[t==="dashboard"&&"Dashboard",t==="purchase-orders"&&"Purchase Orders",t==="quotations"&&"Quotations",t==="invoices"&&"Invoices",t==="billing-notes"&&"Billing Notes",t==="permissions"&&"User Permissions"]})}),t==="dashboard"&&e.jsx(Oe,{data:n}),t==="purchase-orders"&&e.jsx(Ie,{}),t==="quotations"&&e.jsx(Ee,{list:n.quotations,refreshData:j}),t==="invoices"&&e.jsx($e,{list:n.invoices,refreshData:j}),t==="billing-notes"&&e.jsx(Fe,{list:n.billingNotes,refreshData:j}),t==="permissions"&&e.jsx(Le,{})]})]})}function Ke(){const[t,p]=N.useState(!1);return N.useEffect(()=>{try{const n=localStorage.getItem("userRole");(localStorage.getItem("isAuthenticated")!=="true"||n!=="Admin")&&(localStorage.setItem("isAuthenticated","true"),localStorage.setItem("userRole","Admin"),localStorage.setItem("currentUser",JSON.stringify({email:"admin@eit.com",name:"Admin User",role:"Admin",company:"EIT Lasertechnik"})),localStorage.setItem("allowedApps","all"))}catch{}p(!0)},[]),t?e.jsxs("main",{className:"min-h-screen bg-white",children:[e.jsx(je,{}),e.jsx(Re,{})]}):null}Ne.createRoot(document.getElementById("root")).render(e.jsx(N.StrictMode,{children:e.jsx(Se,{children:e.jsx(Ke,{})})}));
